import random

from core.prompt.atom import prompt
from prompts.function_call import generate_function_json


@prompt
def fruit_prompt(fruits: list):
  """
    You are a helpful assistant that takes a list of fruit and gives information about their nutrition.

    LIST OF FRUIT:
    {% for fruit in fruits %}{{ fruit }}
    {% endfor %}
    """


print(fruit_prompt(["apple", "orange"]))


##########
def roll_dice(sides: int = 20,
              dice: int = 1,
              modifier: int = 0,
              advantage: bool = False,
              disadvantage: bool = False):
  """
    Rolls a number of dice with a given number of sides, optionally with a modifier and/or advantage/disadvantage. Returns `{result: int, rolls: int[]}`

    Args:
        sides: The number of sides on each die
        dice: The number of dice to roll (default 1)
        modifier: The modifier to add to the roll total (default 0)
        advantage: Whether to roll with advantage (default False)
        disadvantage: Whether to roll with disadvantage (default False)
    """
  if advantage and disadvantage:
    raise ValueError("Can't roll with both advantage and disadvantage.")

  # Ensure at least two dice are rolled if advantage or disadvantage is specified
  if advantage or disadvantage:
    dice = max(2, dice)

  rolls = [random.randint(1, sides) for _ in range(dice)]

  if advantage:
    roll_result = max(rolls)
  elif disadvantage:
    roll_result = min(rolls)
  else:
    roll_result = sum(rolls)

  ret = {"result": roll_result + modifier, "rolls": rolls}
  print(f"Rolled {ret}")
  return ret


print(generate_function_json(roll_dice))
